/* Sidebar Specific Styles */
@layer components {
    /* Add this to the top level to prevent any horizontal scrolling on the entire page */
    html, body {
        @apply overflow-x-hidden;
        width: 100%;
        position: relative;
        margin: 0;
        padding: 0;
    }

    /* Sidebar container */
    .sidebar {
        @apply bg-primary text-custom-white w-64 flex flex-col fixed top-0 left-0 select-none;
        height: 100vh; /* Full viewport height */
        overflow: hidden; /* Prevent all scrolling inside sidebar */
        transition: width 0.3s ease; /* Only transition width for smoother animation */
        z-index: 40; /* Ensure sidebar is above content but below toggle */
    }
    
    /* Collapsed sidebar styles */
    .sidebar.collapsed {
        @apply w-20;
    }
    
    /* Update main content styles - Fixed width calculation */
    .main-content {
        @apply ml-64 p-4;
        min-height: 100vh;
        overflow-x: hidden;
        width: calc(100% - 16rem); /* Changed from max-width to width */
        transition: margin-left 0.3s ease, width 0.3s ease;
        position: relative;
        z-index: 30; /* Ensure content is below sidebar and toggle */
    }
    
    /* Adjust main content for collapsed sidebar */
    .sidebar-collapsed .main-content {
        @apply ml-20;
        width: calc(100% - 5rem); /* Changed from max-width to width */
    }
    
    .sidebar-header {
        @apply py-6 text-center;
        transition: all 0.3s ease;
        overflow: hidden; /* Added to prevent overflow during transitions */
    }
    
    .sidebar-logo {
        @apply mx-auto w-20 h-20;
        object-fit: contain;
        display: block;
        max-width: 100%;
        transition: all 0.3s ease;
    }
    
    .sidebar-title {
        @apply text-xl font-medium mt-2;
        white-space: nowrap;
        opacity: 1;
        transition: opacity 0.3s ease;
        overflow: hidden; /* Prevent text overflow */
    }
    
    .sidebar-nav {
        @apply mt-10 px-8 py-4; /* Removed sidebar padding to let items control spacing */
        flex: 1; /* Allow nav to grow and fill available space */
        overflow-y: auto; /* Allow scrolling if content is too long */
        overflow-x: hidden; /* Prevent horizontal scroll */
        transition: padding 0.3s ease; /* Changed from all to specific property */
    }
    
    /* Add custom scrollbar for sidebar nav */
    .sidebar-nav::-webkit-scrollbar {
        width: 4px;
    }
    
    .sidebar-nav::-webkit-scrollbar-track {
        @apply bg-primary;
    }
    
    .sidebar-nav::-webkit-scrollbar-thumb {
        @apply bg-secondary rounded;
    }
    
    /* Fixed sidebar link styling with improved spacing */
    .sidebar-link {
        @apply w-full flex items-center justify-start py-2 px-4 rounded-md text-custom-white my-2 transition-colors;
        background-color: transparent;
        position: relative;
    }
    
    .sidebar-link i {
        @apply mr-3 text-lg min-w-[1.5rem] text-center; /* Increased margin between icon and text */
    }
    
    .sidebar-link span {
        @apply text-xs tracking-tight; /* Smaller text with tighter letter spacing */
        white-space: nowrap; /* Keep on single line */
        overflow: hidden; /* Prevent overflow */
        text-overflow: ellipsis; /* Add ellipsis if text is too long */
        opacity: 1;
        transition: opacity 0.2s ease;
    }

    /* Adjusted sidebar nav li padding with more vertical spacing */
    .sidebar-nav li {
        @apply py-1 px-2; /* Added vertical padding for better spacing between items */
    }
    
    /* Fixed active state - Make sure it has higher specificity than hover */
    .sidebar-link.active {
        @apply text-custom-white bg-secondary !important;
    }
    
    /* Ensure hover doesn't override active state */
    .sidebar-link:not(.active):hover {
        @apply bg-secondary !important;
    }
    
    .sidebar-footer {
        @apply mt-auto p-4;
        transition: padding 0.3s ease;
        overflow: hidden;
        flex-shrink: 0; /* Prevent footer from shrinking */
    }
    
    .sidebar-role {
        @apply mb-4 text-custom-white font-bold text-center;
        white-space: nowrap;
        opacity: 1;
        transition: opacity 0.3s ease, margin 0.3s ease;
        overflow: hidden; /* Prevent text overflow */
    }

    .logout-btn {
        @apply flex justify-center;
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .sidebar-logout {
        @apply border border-custom-white text-custom-white py-2 px-3 rounded text-sm transition-colors flex items-center justify-center;
        width: 75%;
        white-space: nowrap;
        transition: all 0.3s ease;
    }
    
    .sidebar-logout:hover {
        @apply bg-secondary text-custom-white;
    }
    
    .sidebar-divider {
        @apply border-t border-custom-white my-1;
        transition: opacity 0.3s ease; /* Changed from all to opacity */
    }
    
    /* Toggle button styles - Improved overlay positioning */
    .sidebar-toggle {
        @apply fixed bg-primary h-10 w-10 rounded-full flex items-center justify-center cursor-pointer;
        top: 50%;
        left: 15rem; /* Position to create a clean overlap with sidebar edge */
        transform: translateY(-50%);
        z-index: 70; /* Ensure it stays above both sidebar and content */
        transition: left 0.3s ease, box-shadow 0.3s ease;
    }

    .sidebar-toggle:hover {
        @apply bg-secondary;
    }
    
    .sidebar-toggle i {
        @apply text-custom-white;
        transition: transform 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
    }
    
    /* Fixed collapsed state toggle position - precise positioning */
    .sidebar.collapsed ~ .sidebar-toggle,
    .sidebar-collapsed .sidebar-toggle {
        left: 4rem; /* Precise position for collapsed state */
    }
    
    .sidebar.collapsed ~ .sidebar-toggle i,
    .sidebar-collapsed .sidebar-toggle i {
        transform: rotate(180deg);
    }
    
    /* Improved collapsed sidebar elements */
    .sidebar.collapsed .sidebar-title,
    .sidebar.collapsed .sidebar-role {
        opacity: 0;
        visibility: hidden;
        height: 0;
        margin: 0;
        overflow: hidden;
    }
    
    .sidebar.collapsed .sidebar-nav span {
        opacity: 0;
        visibility: hidden;
        width: 0;
        display: none; /* Hide completely to prevent layout issues */
    }
    
    .sidebar.collapsed .sidebar-logo {
        @apply w-12 h-12 mx-auto;
    }
    
    .sidebar.collapsed .sidebar-nav {
        @apply px-2; /* Maintain some padding */
    }
    
    .sidebar.collapsed .sidebar-link {
        @apply justify-center px-0 py-2;
        width: 100%;
    }
    
    .sidebar.collapsed .sidebar-link.active {
        @apply bg-secondary;
    }
    
    .sidebar.collapsed .sidebar-link i {
        @apply mx-0 text-xl min-w-0;
    }
    
    .sidebar.collapsed .logout-btn {
        @apply w-full flex justify-center items-center;
    }
    
    .sidebar.collapsed .sidebar-logout {
        @apply w-12 h-12 rounded-full p-0 flex items-center justify-center;
        font-size: 0;
        border-width: 1px;
        margin: 0 auto;
        position: relative;
    }
    
    /* Fixed logout icon for collapsed state */
    .sidebar.collapsed .sidebar-logout::before {
        content: "\f2f5";
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        font-size: 1rem;
        @apply text-custom-white;
        display: block;
    }
}